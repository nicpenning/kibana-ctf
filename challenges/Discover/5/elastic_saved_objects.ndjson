{"attributes":{"description":"","filters":[{"$state":{"store":"appState"},"meta":{"alias":"PowerShell Keylogger - Advanced Search","disabled":false,"index":"35bbc4c9-26e5-4709-a958-2a96608867f2","key":"query","negate":false,"type":"custom","value":"{\"bool\":{\"must\":[],\"filter\":[{\"bool\":{\"filter\":[{\"bool\":{\"should\":[{\"match\":{\"event.category\":\"process\"}}],\"minimum_should_match\":1}},{\"bool\":{\"should\":[{\"match\":{\"host.os.type\":\"windows\"}}],\"minimum_should_match\":1}},{\"bool\":{\"should\":[{\"bool\":{\"should\":[{\"bool\":{\"should\":[{\"match\":{\"powershell.file.script_block_text\":\"GetAsyncKeyState\"}}],\"minimum_should_match\":1}},{\"bool\":{\"should\":[{\"match\":{\"powershell.file.script_block_text\":\"NtUserGetAsyncKeyState\"}}],\"minimum_should_match\":1}},{\"bool\":{\"should\":[{\"match\":{\"powershell.file.script_block_text\":\"GetKeyboardState\"}}],\"minimum_should_match\":1}},{\"bool\":{\"should\":[{\"match_phrase\":{\"powershell.file.script_block_text\":\"Get-Keystrokes\"}}],\"minimum_should_match\":1}}],\"minimum_should_match\":1}},{\"bool\":{\"filter\":[{\"bool\":{\"should\":[{\"bool\":{\"should\":[{\"match\":{\"powershell.file.script_block_text\":\"SetWindowsHookA\"}}],\"minimum_should_match\":1}},{\"bool\":{\"should\":[{\"match\":{\"powershell.file.script_block_text\":\"SetWindowsHookW\"}}],\"minimum_should_match\":1}},{\"bool\":{\"should\":[{\"match\":{\"powershell.file.script_block_text\":\"SetWindowsHookEx\"}}],\"minimum_should_match\":1}},{\"bool\":{\"should\":[{\"match\":{\"powershell.file.script_block_text\":\"SetWindowsHookExA\"}}],\"minimum_should_match\":1}},{\"bool\":{\"should\":[{\"match\":{\"powershell.file.script_block_text\":\"NtUserSetWindowsHookEx\"}}],\"minimum_should_match\":1}}],\"minimum_should_match\":1}},{\"bool\":{\"should\":[{\"bool\":{\"should\":[{\"match\":{\"powershell.file.script_block_text\":\"GetForegroundWindow\"}}],\"minimum_should_match\":1}},{\"bool\":{\"should\":[{\"match\":{\"powershell.file.script_block_text\":\"GetWindowTextA\"}}],\"minimum_should_match\":1}},{\"bool\":{\"should\":[{\"match\":{\"powershell.file.script_block_text\":\"GetWindowTextW\"}}],\"minimum_should_match\":1}},{\"bool\":{\"should\":[{\"match_phrase\":{\"powershell.file.script_block_text\":\"WM_KEYBOARD_LL\"}}],\"minimum_should_match\":1}},{\"bool\":{\"should\":[{\"match_phrase\":{\"powershell.file.script_block_text\":\"WH_MOUSE_LL\"}}],\"minimum_should_match\":1}}],\"minimum_should_match\":1}}]}}],\"minimum_should_match\":1}},{\"bool\":{\"must_not\":{\"bool\":{\"should\":[{\"match_phrase\":{\"user.id\":\"S-1-5-18\"}}],\"minimum_should_match\":1}}}},{\"bool\":{\"must_not\":{\"bool\":{\"filter\":[{\"bool\":{\"should\":[{\"match_phrase\":{\"powershell.file.script_block_text\":\"sentinelbreakpoints\"}}],\"minimum_should_match\":1}},{\"bool\":{\"should\":[{\"match_phrase\":{\"powershell.file.script_block_text\":\"Set-PSBreakpoint\"}}],\"minimum_should_match\":1}},{\"bool\":{\"should\":[{\"match_phrase\":{\"powershell.file.script_block_text\":\"{ctf_fancy_query_in_json}\"}}],\"minimum_should_match\":1}}]}}}}]}}],\"should\":[],\"must_not\":[]}}"},"query":{"bool":{"filter":[{"bool":{"filter":[{"bool":{"minimum_should_match":1,"should":[{"match":{"event.category":"process"}}]}},{"bool":{"minimum_should_match":1,"should":[{"match":{"host.os.type":"windows"}}]}},{"bool":{"minimum_should_match":1,"should":[{"bool":{"minimum_should_match":1,"should":[{"bool":{"minimum_should_match":1,"should":[{"match":{"powershell.file.script_block_text":"GetAsyncKeyState"}}]}},{"bool":{"minimum_should_match":1,"should":[{"match":{"powershell.file.script_block_text":"NtUserGetAsyncKeyState"}}]}},{"bool":{"minimum_should_match":1,"should":[{"match":{"powershell.file.script_block_text":"GetKeyboardState"}}]}},{"bool":{"minimum_should_match":1,"should":[{"match_phrase":{"powershell.file.script_block_text":"Get-Keystrokes"}}]}}]}},{"bool":{"filter":[{"bool":{"minimum_should_match":1,"should":[{"bool":{"minimum_should_match":1,"should":[{"match":{"powershell.file.script_block_text":"SetWindowsHookA"}}]}},{"bool":{"minimum_should_match":1,"should":[{"match":{"powershell.file.script_block_text":"SetWindowsHookW"}}]}},{"bool":{"minimum_should_match":1,"should":[{"match":{"powershell.file.script_block_text":"SetWindowsHookEx"}}]}},{"bool":{"minimum_should_match":1,"should":[{"match":{"powershell.file.script_block_text":"SetWindowsHookExA"}}]}},{"bool":{"minimum_should_match":1,"should":[{"match":{"powershell.file.script_block_text":"NtUserSetWindowsHookEx"}}]}}]}},{"bool":{"minimum_should_match":1,"should":[{"bool":{"minimum_should_match":1,"should":[{"match":{"powershell.file.script_block_text":"GetForegroundWindow"}}]}},{"bool":{"minimum_should_match":1,"should":[{"match":{"powershell.file.script_block_text":"GetWindowTextA"}}]}},{"bool":{"minimum_should_match":1,"should":[{"match":{"powershell.file.script_block_text":"GetWindowTextW"}}]}},{"bool":{"minimum_should_match":1,"should":[{"match_phrase":{"powershell.file.script_block_text":"WM_KEYBOARD_LL"}}]}},{"bool":{"minimum_should_match":1,"should":[{"match_phrase":{"powershell.file.script_block_text":"WH_MOUSE_LL"}}]}}]}}]}}]}},{"bool":{"must_not":{"bool":{"minimum_should_match":1,"should":[{"match_phrase":{"user.id":"S-1-5-18"}}]}}}},{"bool":{"must_not":{"bool":{"filter":[{"bool":{"minimum_should_match":1,"should":[{"match_phrase":{"powershell.file.script_block_text":"sentinelbreakpoints"}}]}},{"bool":{"minimum_should_match":1,"should":[{"match_phrase":{"powershell.file.script_block_text":"Set-PSBreakpoint"}}]}},{"bool":{"minimum_should_match":1,"should":[{"match_phrase":{"powershell.file.script_block_text":"{ctf_fancy_query_in_json}"}}]}}]}}}}]}}],"must":[],"must_not":[],"should":[]}}}],"query":{"language":"kuery","query":""},"timefilter":null,"title":"Advanced Hunting","titleKeyword":"Advanced Hunting"},"coreMigrationVersion":"8.8.0","created_at":"2024-12-13T03:56:17.217Z","created_by":"u_mGBROF_q5bmFCATbLXAcCwKa0k8JvONAwSruelyKA5E_0","id":"174054b1-9c15-4238-b998-0dd955921011","managed":false,"references":[{"id":"                                                                                                                                       {ctf_sweet_my_own_data_view_id}","name":"35bbc4c9-26e5-4709-a958-2a96608867f2","type":"index-pattern"}],"type":"query","typeMigrationVersion":"10.2.0","updated_at":"2024-12-13T03:56:17.217Z","updated_by":"u_mGBROF_q5bmFCATbLXAcCwKa0k8JvONAwSruelyKA5E_0","version":"WzEzOSwxXQ=="}
{"excludedObjects":[],"excludedObjectsCount":0,"exportedCount":1,"missingRefCount":0,"missingReferences":[]}
